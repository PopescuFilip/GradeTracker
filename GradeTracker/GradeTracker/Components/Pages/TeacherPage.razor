@page "/teacher"
@rendermode InteractiveServer
@attribute [StreamRendering]
@attribute [Authorize(Roles = Roles.Teacher)]
@using GradeTracker.ViewModels;
@using Radzen
@using Radzen.Blazor

<PageTitle>Teacher page</PageTitle>

<h1>Teacher info</h1>

<RadzenDataGrid @ref="@gradeGrid" Data="@grades" TItem="GradeViewModel" AllowFiltering="true" AllowColumnResize="true"
				AllowAlternatingRows="false" FilterMode="FilterMode.Simple" AllowSorting="true" PageSize="5"
				AllowPaging="true" PagerHorizontalAlign="HorizontalAlign.Left"
				ColumnWidth="300px">
	<Columns>
		<RadzenDataGridColumn TItem="GradeViewModel" Property="Grade" Title="Grade">
			<Template>
				@context.Grade
			</Template>
			<EditTemplate>
				<RadzenNumeric @bind-Value="@context.Grade" />
			</EditTemplate>
		</RadzenDataGridColumn>
		<RadzenDataGridColumn TItem="GradeViewModel" Property="DateCreated" Title="Date Created">
			<Template>
				@context.DateCreated.ToString("dd/MM/yyyy")
			</Template>
			<EditTemplate>
				@context.DateCreated.ToString("dd/MM/yyyy")
			</EditTemplate>
		</RadzenDataGridColumn>
		<RadzenDataGridColumn TItem="GradeViewModel" Property="StudentFullName" Title="Student FullName">
			<Template>
				@context.StudentFullName
			</Template>
			<EditTemplate>
				@context.StudentFullName
			</EditTemplate>
		</RadzenDataGridColumn>
		<RadzenDataGridColumn Filterable="false" Sortable="false" TextAlign="TextAlign.Right" Frozen="true" FrozenPosition="FrozenColumnPosition.Right">
			<Template>
				<RadzenButton Icon="edit" ButtonStyle="ButtonStyle.Light" Variant="Variant.Flat" Size="ButtonSize.Medium" class="rz-my-1 rz-ms-1" Click="@(args => EditRow(context))" @onclick:stopPropagation="true" />
				<RadzenButton Icon="delete" ButtonStyle="ButtonStyle.Danger" Variant="Variant.Flat" Size="ButtonSize.Medium" Shade="Shade.Lighter" class="rz-my-1 rz-ms-1" Click="@(args => DeleteRow(context))" @onclick:stopPropagation="true" />
			</Template>
			<EditTemplate>
				<RadzenButton Icon="check" ButtonStyle="ButtonStyle.Success" Variant="Variant.Flat" Size="ButtonSize.Medium" Click="@((args) => SaveRow(context))" aria-label="Save" />
				<RadzenButton Icon="close" ButtonStyle="ButtonStyle.Light" Variant="Variant.Flat" Size="ButtonSize.Medium" class="rz-my-1 rz-ms-1" Click="@((args) => CancelEdit(context))" aria-label="Cancel" />
				<RadzenButton Icon="delete" ButtonStyle="ButtonStyle.Danger" Variant="Variant.Flat" Size="ButtonSize.Medium" Shade="Shade.Lighter" class="rz-my-1 rz-ms-1" Click="@(args => DeleteRow(context))" aria-label="Delete" />
			</EditTemplate>
		</RadzenDataGridColumn>
	</Columns>
</RadzenDataGrid>

<button style="margin-top:15px;" class="btn btn-primary mb-3" @onclick="ShowCreateGradeModal">Add New Grade</button>

@if (IsCreateGradeModalVisible)
{
	<CreateGrade IsVisible="@IsCreateGradeModalVisible" SubjectId="@SubjectId" OnVisibilityChanged="HandleCreateModelVisibility" OnGradeCreated="HandleGradeCreated" />
}